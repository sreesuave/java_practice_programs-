package Maven_examples;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Statement;

public class Sql_Write {

    public static void main(String[] args) {
        String url = "jdbc:mysql://localhost:3306/test_db";
        String username = "root";
        String dbpassword = "admin";

        try {
            // 1. Connect to database
            Connection conn = DriverManager.getConnection(url, username, dbpassword);
            System.out.println("Database connected");

            // 2. Prepare insert statement
            String sql = "INSERT INTO UserLoginDetails (userid, password) VALUES (?, ?)";
            PreparedStatement stmt = conn.prepareStatement(sql);

            // 3. Set values for one record
            stmt.setString(1, "new_user1");
            stmt.setString(2, "securePass123");

            // 4. Execute insert
            int rowsInserted = stmt.executeUpdate();
            if (rowsInserted > 0) {
                System.out.println("One record inserted successfully.");
            }
            stmt.close(); // Close the insert statement before running SELECT

            // 5. Create Statement for SELECT
            Statement stmt1 = conn.createStatement();
            String sql1 = "SELECT userid, password FROM UserLoginDetails";
            ResultSet rs = stmt1.executeQuery(sql1);

            // 6. Loop through results
            while (rs.next()) {
                String userid = rs.getString("userid");
                String password = rs.getString("password");
                System.out.println("UserID: " + userid + " | Password: " + password);
            }

            // 7. Close resources
            rs.close();
            stmt1.close();
            conn.close();

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
